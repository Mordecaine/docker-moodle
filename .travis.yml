language: shell
os: linux
dist: xenial
git:
  depth: false

services:
  - docker

env:
  global:
    - LATEST=39
    - LATEST_LTS=39
  jobs:
    - "DB_TYPE=all VERSION=35 DOCKERFILE=dockerfiles/apache/Dockerfile"
    - "DB_TYPE=mysqli VERSION=35 DOCKERFILE=dockerfiles/apache/Dockerfile"
    - "DB_TYPE=pgsql  VERSION=35 DOCKERFILE=dockerfiles/apache/Dockerfile"
    - "DB_TYPE=all VERSION=35 DOCKERFILE=dockerfiles/fpm_alpine/Dockerfile"
    - "DB_TYPE=mysqli VERSION=35 DOCKERFILE=dockerfiles/fpm_alpine/Dockerfile"
    - "DB_TYPE=pgsql VERSION=35 DOCKERFILE=dockerfiles/fpm_alpine/Dockerfile"

  
script: bash ./travis/build.sh

deploy:
  - provider: script
    on:
       branch: master
    script: bash ./travis/deploy.sh

jobs:
  include:
    - stage: version-36
      env: VERSION=36
      script: bash ./travis/build.sh
    - stage: version-37
      env: VERSION=37
      script: bash ./travis/build.sh
    - stage: version-38
      env: VERSION=38
      script: bash ./travis/build.sh
    - stage: version-39
      env: VERSION=39
      script: bash ./travis/build.sh  
    - stage: version-310
      env: VERSION=310
      script: bash ./travis/build.sh
    